<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Background Remover</title>
<style>
body {
    background: #111;
    color: white;
    font-family: Arial;
    text-align: center;
}
#drop {
    margin: 20px auto;
    width: 400px;
    padding: 40px;
    border: 2px dashed #555;
    cursor: pointer;
}
#browse {
    margin: 10px auto;
}
img {
    margin-top: 20px;
    max-width: 400px;
    display: block;
    margin-left: auto;
    margin-right: auto;
}
button {
    background: #555;
    color: white;
    border: none;
    padding: 10px 20px;
    margin: 10px;
    cursor: pointer;
}
button:hover {
    background: #777;
}
</style>
</head>
<body>

<h1>AI Background Remover</h1>

<div id="drop">Drag & Drop Image Here</div>

<div id="browse">
    <input type="file" id="fileInput" accept="image/*">
    <button id="uploadBtn">Upload & Remove BG</button>
</div>

<img id="result">

<script>
const drop = document.getElementById("drop");
const fileInput = document.getElementById("fileInput");
const uploadBtn = document.getElementById("uploadBtn");
const result = document.getElementById("result");

async function processFile(file) {
    const form = new FormData();
    form.append("file", file);

    drop.innerText = "Processing...";
    uploadBtn.disabled = true;

    try {
        const res = await fetch("http://127.0.0.1:8000/remove-bg", {
            method: "POST",
            body: form
        });

        if (!res.ok) throw new Error("Server error");

        const blob = await res.blob();
        result.src = URL.createObjectURL(blob);

        // Auto-download
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "cutout.png";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        drop.innerText = "Drop another image or browse";
    } catch (err) {
        drop.innerText = "Error connecting to server";
        console.error(err);
    } finally {
        uploadBtn.disabled = false;
    }
}

// Drag & Drop
drop.ondragover = e => e.preventDefault();
drop.ondrop = e => {
    e.preventDefault();
    const file = e.dataTransfer.files[0];
    if (file) processFile(file);
};

// Browse Button
uploadBtn.onclick = () => {
    const file = fileInput.files[0];
    if (file) processFile(file);
};
</script>

</body>
</html>
